import{_ as U}from"./BxrCnKvl.js";import{e as K,s as M,r as f,f as j,g as w,h as P,i as $,j as G,k as g,o as p,w as o,b as a,l as C,m,a as i,t as b,c as _,d as c,n as H}from"#entry";import{i as Q,a as z,b as W,F as X,V as Y,c as Z}from"./Dv-DsaCA.js";import{u as ee,c as te}from"./BrDNHwyU.js";import{V as se,a as oe,b as h,c as B,d as N,e as ae,f as le}from"./HDF-tfVa.js";import{V as T}from"./BjKJM1WQ.js";import"./Do3iAHZB.js";const ne={class:"font-bold"},re={key:0,class:"text-medium-emphasis"},ue={key:1},ie={style:{"white-space":"pre-wrap"}},de={key:0,class:"mt-4"},me={class:"text-subtitle-2 mb-2"},ce={style:{"white-space":"pre-wrap"}},we=K({__name:"form",setup(fe){const R=ee(),{schema:n,formData:r}=M(R),D=f(""),F=f("info"),v=f(!1),V=f(!1),d=f(null),O=j(),y=(t,e="info")=>{D.value=t,F.value=e},I=()=>{const t=O.query.name||"";if(t)try{const s=localStorage.getItem("schemaBuilder.schemas");if(s){const u=JSON.parse(s).find(k=>t===k.name);if(console.log(u),u){const k=Array.isArray(u.items)?te(u):u;n.value=k,y(`Loaded saved schema: ${u.name}`,"success");return}}}catch{}const e=localStorage.getItem("schemaBuilder.tempImport");if(e){try{const s=JSON.parse(e);n.value=s,y("Imported schema from file.","success")}catch{}return}n.value=null},x=async()=>{const t={...r.value};v.value=!0,d.value=null;const e=n.value?.endpoint;if(e)try{V.value=!0;const s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});let l="";try{l=await s.text()}catch{l=""}d.value={status:s.status,body:l},y(s.ok?"Submitted successfully":"Submission failed",s.ok?"success":"error")}catch(s){d.value={status:0,body:String(s)},y("Submission error","error")}finally{V.value=!1}},L=w(()=>JSON.stringify(r.value,null,2)),A=w(()=>{const t=n.value?.items;return t?Array.isArray(t)?t:Object.values(t):[]}),q=t=>z(t),E=t=>Q(t,r.value),J=w(()=>{if(!n.value)return!1;for(const t of A.value)if(E(t)&&q(t)&&!W(r.value[t.name]))return!1;return!0});P(()=>{I()});let S=[];return $(()=>{const t=s=>{s.preventDefault()},e=s=>{const l=(s.key||"").toUpperCase();(l==="F12"||s.ctrlKey&&s.shiftKey&&["I","J","C"].includes(l)||s.ctrlKey&&l==="U")&&(s.preventDefault(),s.stopPropagation())};document.addEventListener("contextmenu",t),window.addEventListener("keydown",e,!0),S=[()=>document.removeEventListener("contextmenu",t),()=>window.removeEventListener("keydown",e,!0)]}),G(()=>{for(const t of S)try{t()}catch{}S=[]}),(t,e)=>{const s=U;return p(),g(le,{class:"pa-6"},{default:o(()=>[a(se,null,{default:o(()=>[a(oe,{cols:"12",md:"12"},{default:o(()=>[a(h,null,{default:o(()=>[m(n)?(p(),g(B,{key:0,class:"mb-4"},{default:o(()=>[i("span",ne,b(m(n)?.label),1),e[3]||(e[3]=i("br",null,null,-1)),e[4]||(e[4]=i("p",{class:"text-error text-[0.75rem]"}," All fields marked with * are required. ",-1))]),_:1})):C("",!0),a(N,null,{default:o(()=>[m(n)?(p(),_("div",ue,[a(X,{schema:m(n),modelValue:m(r),"onUpdate:modelValue":e[0]||(e[0]=l=>H(r)?r.value=l:null),showSubmit:!1,onSubmit:x},null,8,["schema","modelValue"]),a(T,{class:"mt-4",color:"primary",disabled:!m(n)||V.value||!J.value,onClick:x},{default:o(()=>[...e[8]||(e[8]=[c(" Submit ",-1)])]),_:1},8,["disabled"])])):(p(),_("div",re,[e[6]||(e[6]=c(" No schema loaded. Go to ",-1)),a(s,{to:"/",class:"underline"},{default:o(()=>[...e[5]||(e[5]=[c("Home",-1)])]),_:1}),e[7]||(e[7]=c(" to select or import a schema. ",-1))]))]),_:1})]),_:1})]),_:1})]),_:1}),a(Y,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=l=>v.value=l),"max-width":"700"},{default:o(()=>[a(h,null,{default:o(()=>[a(B,null,{default:o(()=>[...e[9]||(e[9]=[c("Submitted Data",-1)])]),_:1}),a(N,null,{default:o(()=>[e[10]||(e[10]=i("div",{class:"text-subtitle-2 mb-2"},"Payload",-1)),i("pre",ie,b(L.value),1),d.value?(p(),_("div",de,[i("div",me," Response ("+b(d.value.status)+") ",1),i("pre",ce,b(d.value.body),1)])):C("",!0)]),_:1}),a(ae,null,{default:o(()=>[a(Z),a(T,{color:"black","prepend-icon":"mdi-close-circle",variant:"tonal",onClick:e[1]||(e[1]=l=>v.value=!1)},{default:o(()=>[...e[11]||(e[11]=[c("Close",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}});export{we as default};
